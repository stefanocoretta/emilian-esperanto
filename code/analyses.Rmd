---
title: "Analyses"
author: "Stefano Coretta"
date: "10/09/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = here::here())
library(tidyverse)
theme_set(theme_light())
```

# Read data

```{r data}
headings_em <- read_csv("data/raw/headings-emilian.csv")
headings_eo <- read_csv("data/raw/headings-esperanto.csv")

emilian <- read_csv("data/raw/emilian-clean.csv", skip = 1, col_names = headings_em$new, na = c("", "NA")) %>%
  mutate(
    understand = factor(understand, levels = c("NO", "AL", "50/50", "G", "VG")),
    speak = factor(speak, levels = c("NO", "AL", "50/50", "G", "VG"))
  )

esperanto <- read_csv("data/raw/esperanto-clean.csv", skip = 1, col_names = headings_eo$new, na = c("", "NA")) %>%
  mutate(
    age = str_remove(age, "jaroj"),
    age = str_replace(age, "naskiĝis en la 1995a", "25"),
    age = as.numeric(age),
    understand = factor(understand, levels = c("NO", "AL", "50/50", "G", "VG")),
    speak = factor(speak, levels = c("NO", "AL", "50/50", "G", "VG"))
  )
```

# Descriptive

## Emilian

### Participants

```{r em-gender}
emilian %>%
  ggplot(aes(gender)) +
  geom_bar()
```

```{r em-age}
emilian %>%
  ggplot(aes(age)) +
  geom_histogram()

emilian %>%
  ggplot(aes(age)) +
  geom_density()
```

```{r em-education}
emilian %>%
  ggplot(aes(education)) +
  geom_bar()
```

```{r em-age-edu}
emilian %>%
  ggplot(aes(age, education)) +
  geom_jitter(height = 0.2, alpha = 0.5)
```

```{r em-occupation}
emilian %>%
  count(profession) %>%
  ggplot(aes(reorder(profession, -n), n)) +
  geom_bar(stat = "identity")
```

### Language

```{r em-understand}
emilian %>%
  ggplot(aes(understand, fill = understand)) +
  geom_bar() +
  scale_fill_brewer(type = "div")
```

```{r em-understand-gender}
emilian %>%
  ggplot(aes(understand, fill = gender)) +
  geom_bar()
```

```{r em-speak}
emilian %>%
  ggplot(aes(speak, fill = speak)) +
  geom_bar() +
  scale_fill_brewer(type = "div")
```

```{r em-speak-gender}
emilian %>%
  ggplot(aes(speak, fill = gender)) +
  geom_bar()
```

```{r em-read-write}
emilian %>%
  ggplot(aes(read_write, fill = read_write)) +
  geom_bar()
```

```{r em-read-write-gender}
emilian %>%
  ggplot(aes(read_write, fill = gender)) +
  geom_bar()
```

```{r em-attitude}
emilian %>%
  select(educated:familiar) %>%
  pivot_longer(educated:familiar, names_to = "feature", values_to = "rating") %>%
  ggplot(aes(as.factor(rating), fill = as.factor(rating))) +
  geom_bar() +
  scale_fill_brewer() +
  facet_grid(. ~ feature)
```


## Esperanto

### Participants

```{r eo-gender}
esperanto %>%
  ggplot(aes(gender)) +
  geom_bar()
```

```{r eo-age}
esperanto %>%
  ggplot(aes(age)) +
  geom_histogram()

esperanto %>%
  ggplot(aes(age)) +
  geom_density()
```

```{r eo-education}
esperanto %>%
  ggplot(aes(education)) +
  geom_bar()
```

```{r eo-age-edu}
esperanto %>%
  ggplot(aes(age, education)) +
  geom_jitter(height = 0.2, alpha = 0.5)
```

```{r eo-occupation}
esperanto %>%
  count(profession) %>%
  ggplot(aes(reorder(profession, -n), n)) +
  geom_bar(stat = "identity")
```

### Language

```{r eo-understand}
esperanto %>%
  ggplot(aes(understand, fill = understand)) +
  geom_bar() +
  scale_fill_brewer(type = "div")
```

```{r eo-understand-gender}
esperanto %>%
  ggplot(aes(understand, fill = gender)) +
  geom_bar()
```

```{r eo-speak}
esperanto %>%
  ggplot(aes(speak, fill = speak)) +
  geom_bar() +
  scale_fill_brewer(type = "div")
```


```{r eo-speak-gender}
esperanto %>%
  ggplot(aes(speak, fill = gender)) +
  geom_bar()
```

```{r em-read-write}
esperanto %>%
  ggplot(aes(read_write, fill = read_write)) +
  geom_bar()
```

```{r eo-attitude}
esperanto %>%
  select(educated:familiar) %>%
  pivot_longer(educated:familiar, names_to = "feature", values_to = "rating") %>%
  drop_na() %>%
  ggplot(aes(as.factor(rating), fill = as.factor(rating))) +
  geom_bar() +
  scale_fill_brewer() +
  facet_grid(. ~ feature)
```

